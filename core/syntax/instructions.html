<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Instructions &#8212; WebAssembly 3.0 (2025-09-23)</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=057308f9" />
    <script src="../_static/documentation_options.js?v=f88ca30f"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>window.MathJax = {"tex": {"maxBuffer": 30720, "macros": {"multicolumn": ["", 2]}}, "options": {"menuOptions": {"settings": {"enrich": false}}}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modules" href="modules.html" />
    <link rel="prev" title="Types" href="types.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/webassembly.png" alt="Logo of WebAssembly"/>
            </a></p><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Structure</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="conventions.html">Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="values.html">Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">Types</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">Modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../valid/index.html">Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exec/index.html">Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../binary/index.html">Binary Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../text/index.html">Text Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">Appendix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index-types.html">Index of Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index-instructions.html">Index of Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index-rules.html">Index of Semantic Rules</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="../genindex.html">Index</a></li>
    
    <li class="toctree-l1"><a href="../_download/WebAssembly.pdf">Download as PDF</a></li>
    
</ul>

<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="instructions">
<span id="syntax-instr"></span><span id="index-0"></span><h1>Instructions<a class="headerlink" href="#instructions" title="Link to this heading">¶</a></h1>
<p>WebAssembly code consists of sequences of <em>instructions</em>.
Its computational model is based on a <em>stack machine</em> in that instructions manipulate values on an implicit <em>operand stack</em>,
consuming (popping) argument values and producing or returning (pushing) result values.</p>
<p>In addition to dynamic operands from the stack, some instructions also have static <em>immediate</em> arguments,
typically <a class="reference internal" href="modules.html#syntax-index"><span class="std std-ref">indices</span></a> or type annotations,
which are part of the instruction itself.</p>
<p>Some instructions are <a class="reference internal" href="#syntax-instr-control"><span class="std std-ref">structured</span></a> in that they contain nested sequences of instructions.</p>
<p>The following sections group instructions into a number of different categories.</p>
<p>The syntax of instruction is further <a class="reference internal" href="../exec/runtime.html#syntax-instr-admin"><span class="std std-ref">extended</span></a> with additional forms for the purpose of specifying <a class="reference internal" href="../exec/index.html#exec"><span class="std std-ref">execution</span></a>.</p>
<section id="parametric-instructions">
<span id="syntax-instr-parametric"></span><span id="index-1"></span><h2>Parametric Instructions<a class="headerlink" href="#parametric-instructions" title="Link to this heading">¶</a></h2>
<p>Instructions in this group can operate on operands of any <a class="reference internal" href="types.html#syntax-valtype"><span class="std std-ref">value type</span></a>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{nop}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{unreachable}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-parametric}{\mathsf{drop}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-parametric}{\mathsf{select}}~{({{\href{../syntax/types.html#syntax-valtype}{\mathit{valtype}}}^\ast})^?} \\
&amp; &amp; | &amp; \dots \\
\end{array}\end{split}\]</div>
<p>The <span class="math notranslate nohighlight">\(\mathsf{nop}\)</span> instruction does nothing.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{unreachable}\)</span> instruction causes an unconditional <a class="reference internal" href="../intro/overview.html#trap"><span class="std std-ref">trap</span></a>.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{drop}\)</span> instruction simply throws away a single operand.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{select}\)</span> instruction selects one of its first two operands based on whether its third operand is zero or not.
It may include a <a class="reference internal" href="types.html#syntax-valtype"><span class="std std-ref">value type</span></a> determining the type of these operands.
If missing, the operands must be of <a class="reference internal" href="types.html#syntax-numtype"><span class="std std-ref">numeric</span></a> or <a class="reference internal" href="types.html#syntax-vectype"><span class="std std-ref">vector</span></a> type.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In future versions of WebAssembly, the type annotation on <span class="math notranslate nohighlight">\(\mathsf{select}\)</span> may allow for more than a single value being selected at the same time.</p>
</div>
</section>
<section id="control-instructions">
<span id="exception"></span><span id="syntax-catch"></span><span id="syntax-try-table"></span><span id="syntax-throw-ref"></span><span id="syntax-throw"></span><span id="syntax-instr-control"></span><span id="syntax-instrs"></span><span id="syntax-call-indirect"></span><span id="syntax-call"></span><span id="syntax-return"></span><span id="syntax-br-on-cast-fail"></span><span id="syntax-br-on-cast"></span><span id="syntax-br-on-non-null"></span><span id="syntax-br-on-null"></span><span id="syntax-br-table"></span><span id="syntax-br-if"></span><span id="syntax-br"></span><span id="syntax-if"></span><span id="syntax-loop"></span><span id="syntax-block"></span><span id="syntax-unreachable"></span><span id="syntax-nop"></span><span id="index-2"></span><h2>Control Instructions<a class="headerlink" href="#control-instructions" title="Link to this heading">¶</a></h2>
<p>Instructions in this group affect the flow of control.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \dots \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{block}}~{\href{../syntax/types.html#syntax-blocktype}{\mathit{blocktype}}}~{{\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}}^\ast} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{loop}}~{\href{../syntax/types.html#syntax-blocktype}{\mathit{blocktype}}}~{{\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}}^\ast} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{if}}~{\href{../syntax/types.html#syntax-blocktype}{\mathit{blocktype}}}~{{\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}}^\ast}~\href{../syntax/instructions.html#syntax-instr-control}{\mathsf{else}}~{{\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}}^\ast} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{br}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{br\_if}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{br\_table}}~{{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}}^\ast}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{br\_on\_null}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{br\_on\_non\_null}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{br\_on\_cast}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}}~{\href{../syntax/types.html#syntax-reftype}{\mathit{reftype}}}~{\href{../syntax/types.html#syntax-reftype}{\mathit{reftype}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{br\_on\_cast\_fail}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}}~{\href{../syntax/types.html#syntax-reftype}{\mathit{reftype}}}~{\href{../syntax/types.html#syntax-reftype}{\mathit{reftype}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{call}}~{\href{../syntax/modules.html#syntax-funcidx}{\mathit{funcidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{call\_ref}}~{\href{../syntax/types.html#syntax-typeuse}{\mathit{typeuse}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{call\_indirect}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}}~{\href{../syntax/types.html#syntax-typeuse}{\mathit{typeuse}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{return}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{return\_call}}~{\href{../syntax/modules.html#syntax-funcidx}{\mathit{funcidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{return\_call\_ref}}~{\href{../syntax/types.html#syntax-typeuse}{\mathit{typeuse}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{return\_call\_indirect}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}}~{\href{../syntax/types.html#syntax-typeuse}{\mathit{typeuse}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{throw}}~{\href{../syntax/modules.html#syntax-tagidx}{\mathit{tagidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{throw\_ref}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{try\_table}}~{\href{../syntax/types.html#syntax-blocktype}{\mathit{blocktype}}}~{\href{../syntax/conventions.html#syntax-list}{\mathit{list}}}({\href{../syntax/instructions.html#syntax-catch}{\mathit{catch}}})~{{\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}}^\ast} \\
&amp; &amp; | &amp; \dots \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-catch}{\mathit{catch}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{catch}}~{\href{../syntax/modules.html#syntax-tagidx}{\mathit{tagidx}}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{catch\_ref}}~{\href{../syntax/modules.html#syntax-tagidx}{\mathit{tagidx}}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{catch\_all}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-control}{\mathsf{catch\_all\_ref}}~{\href{../syntax/modules.html#syntax-labelidx}{\mathit{labelidx}}} \\
\end{array}\end{split}\]</div>
<p>The <span class="math notranslate nohighlight">\(\mathsf{block}\)</span>, <span class="math notranslate nohighlight">\(\mathsf{loop}\)</span>, <span class="math notranslate nohighlight">\(\mathsf{if}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{try\_table}\)</span> instructions are <em>structured</em> instructions.
They bracket nested sequences of instructions, called <em>blocks</em>.
As the grammar prescribes, they must be well-nested.</p>
<p>A structured instruction can consume <em>input</em> and produce <em>output</em> on the operand stack according to its annotated <a class="reference internal" href="types.html#syntax-blocktype"><span class="std std-ref">block type</span></a>.</p>
<p>Each structured control instruction introduces an implicit <em>label</em>.
Labels are targets for branch instructions that reference them with <a class="reference internal" href="modules.html#syntax-labelidx"><span class="std std-ref">label indices</span></a>.
Unlike with other <a class="reference internal" href="modules.html#syntax-index"><span class="std std-ref">index spaces</span></a>, indexing of labels is relative by nesting depth,
that is, label <span class="math notranslate nohighlight">\(0\)</span> refers to the innermost structured control instruction enclosing the referring branch instruction,
while increasing indices refer to those farther out.
Consequently, labels can only be referenced from <em>within</em> the associated structured control instruction.
This also implies that branches can only be directed outwards,
“breaking” from the block of the control construct they target.
The exact effect depends on that control construct.
In case of <span class="math notranslate nohighlight">\(\mathsf{block}\)</span> or <span class="math notranslate nohighlight">\(\mathsf{if}\)</span> it is a <em>forward jump</em>,
resuming execution after the end of the block.
In case of <span class="math notranslate nohighlight">\(\mathsf{loop}\)</span> it is a <em>backward jump</em> to the beginning of the loop.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This enforces <em>structured control flow</em>.
Intuitively, a branch targeting a <span class="math notranslate nohighlight">\(\mathsf{block}\)</span> or <span class="math notranslate nohighlight">\(\mathsf{if}\)</span> behaves like a <span class="math notranslate nohighlight">\(\mathsf{break}\)</span> statement in most C-like languages,
while a branch targeting a <span class="math notranslate nohighlight">\(\mathsf{loop}\)</span> behaves like a <span class="math notranslate nohighlight">\(\mathsf{continue}\)</span> statement.</p>
</div>
<p>Branch instructions come in several flavors:
<span class="math notranslate nohighlight">\(\mathsf{br}\)</span> performs an unconditional branch,
<span class="math notranslate nohighlight">\(\mathsf{br\_if}\)</span> performs a conditional branch,
and <span class="math notranslate nohighlight">\(\mathsf{br\_table}\)</span> performs an indirect branch through an operand indexing into the label list that is an immediate to the instruction, or to a default target if the operand is out of bounds.
The <span class="math notranslate nohighlight">\(\mathsf{br\_on\_null}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{br\_on\_non\_null}\)</span> instructions check whether a reference operand is <a class="reference internal" href="../exec/runtime.html#syntax-nullref"><span class="std std-ref">null</span></a> and branch if that is the case or not the case, respectively.
Similarly, <span class="math notranslate nohighlight">\(\mathsf{br\_on\_cast}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{br\_on\_cast\_fail}\)</span> attempt a downcast on a reference operand and branch if that succeeds, or fails, respectively.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{return}\)</span> instruction is a shortcut for an unconditional branch to the outermost block, which implicitly is the body of the current function.
Taking a branch <em>unwinds</em> the operand stack up to the height where the targeted structured control instruction was entered.
However, branches may additionally consume operands themselves, which they push back on the operand stack after unwinding.
Forward branches require operands according to the output of the targeted block’s type, i.e., represent the values produced by the terminated block.
Backward branches require operands according to the input of the targeted block’s type, i.e., represent the values consumed by the restarted block.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{call}\)</span> instruction invokes another <a class="reference internal" href="modules.html#syntax-func"><span class="std std-ref">function</span></a>, consuming the necessary arguments from the stack and returning the result values of the call.
The <span class="math notranslate nohighlight">\(\mathsf{call\_ref}\)</span> instruction invokes a function indirectly through a <a class="reference internal" href="types.html#syntax-reftype"><span class="std std-ref">function reference</span></a> operand.
The <span class="math notranslate nohighlight">\(\mathsf{call\_indirect}\)</span> instruction calls a function indirectly through an operand indexing into a <a class="reference internal" href="modules.html#syntax-table"><span class="std std-ref">table</span></a> that is denoted by a <a class="reference internal" href="modules.html#syntax-tableidx"><span class="std std-ref">table index</span></a> and must contain <a class="reference internal" href="types.html#syntax-reftype"><span class="std std-ref">function references</span></a>.
Since it may contain functions of heterogeneous type,
the callee is dynamically checked against the <a class="reference internal" href="types.html#syntax-functype"><span class="std std-ref">function type</span></a> indexed by the instruction’s second immediate, and the call is aborted with a <a class="reference internal" href="../intro/overview.html#trap"><span class="std std-ref">trap</span></a> if it does not match.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{return\_call}\)</span>, <span class="math notranslate nohighlight">\(\mathsf{return\_call\_ref}\)</span>, and <span class="math notranslate nohighlight">\(\mathsf{return\_call\_indirect}\)</span> instructions are <em>tail-call</em> variants of the previous ones.
That is, they first return from the current function before actually performing the respective call.
It is guaranteed that no sequence of nested calls using only these instructions can cause resource exhaustion due to hitting an <a class="reference internal" href="../appendix/implementation.html#impl-exec"><span class="std std-ref">implementation’s limit</span></a> on the number of active calls.</p>
<p>The instructions <span class="math notranslate nohighlight">\(\mathsf{throw}\)</span>, <span class="math notranslate nohighlight">\(\mathsf{throw\_ref}\)</span>, and <span class="math notranslate nohighlight">\(\mathsf{try\_table}\)</span> are concerned with <em>exceptions</em>.
The <span class="math notranslate nohighlight">\(\mathsf{throw}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{throw\_ref}\)</span> instructions raise and reraise an exception, respectively, and transfers control to the innermost enclosing exception handler that has a matching catch clause.
The <span class="math notranslate nohighlight">\(\mathsf{try\_table}\)</span> instruction installs an exception <em>handler</em> that handles exceptions as specified by its catch clauses.</p>
</section>
<section id="variable-instructions">
<span id="syntax-instr-variable"></span><span id="index-3"></span><h2>Variable Instructions<a class="headerlink" href="#variable-instructions" title="Link to this heading">¶</a></h2>
<p>Variable instructions are concerned with access to <a class="reference internal" href="modules.html#syntax-local"><span class="std std-ref">local</span></a> or <a class="reference internal" href="modules.html#syntax-global"><span class="std std-ref">global</span></a> variables.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \dots \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-variable}{\mathsf{local{.}get}}~{\href{../syntax/modules.html#syntax-localidx}{\mathit{localidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-variable}{\mathsf{local{.}set}}~{\href{../syntax/modules.html#syntax-localidx}{\mathit{localidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-variable}{\mathsf{local{.}tee}}~{\href{../syntax/modules.html#syntax-localidx}{\mathit{localidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-variable}{\mathsf{global{.}get}}~{\href{../syntax/modules.html#syntax-globalidx}{\mathit{globalidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-variable}{\mathsf{global{.}set}}~{\href{../syntax/modules.html#syntax-globalidx}{\mathit{globalidx}}} \\
&amp; &amp; | &amp; \dots \\
\end{array}\end{split}\]</div>
<p>These instructions get or set the values of respective variables.
The <span class="math notranslate nohighlight">\(\mathsf{local{.}tee}\)</span> instruction is like <span class="math notranslate nohighlight">\(\mathsf{local{.}set}\)</span> but also returns its argument.</p>
</section>
<section id="table-instructions">
<span id="syntax-table-fill"></span><span id="syntax-table-grow"></span><span id="syntax-table-size"></span><span id="syntax-table-set"></span><span id="syntax-table-get"></span><span id="syntax-instr-table"></span><span id="index-4"></span><h2>Table Instructions<a class="headerlink" href="#table-instructions" title="Link to this heading">¶</a></h2>
<p>Instructions in this group are concerned with tables <a class="reference internal" href="modules.html#syntax-table"><span class="std std-ref">table</span></a>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \dots \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-table}{\mathsf{table{.}get}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-table}{\mathsf{table{.}set}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-table}{\mathsf{table{.}size}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-table}{\mathsf{table{.}grow}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-table}{\mathsf{table{.}fill}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-table}{\mathsf{table{.}copy}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-table}{\mathsf{table{.}init}}~{\href{../syntax/modules.html#syntax-tableidx}{\mathit{tableidx}}}~{\href{../syntax/modules.html#syntax-elemidx}{\mathit{elemidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-table}{\mathsf{elem{.}drop}}~{\href{../syntax/modules.html#syntax-elemidx}{\mathit{elemidx}}} \\
&amp; &amp; | &amp; \dots \\
\end{array}\end{split}\]</div>
<p>The <span class="math notranslate nohighlight">\(\mathsf{table{.}get}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{table{.}set}\)</span> instructions load or store an element in a table, respectively.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{table{.}size}\)</span> instruction returns the current size of a table.
The <span class="math notranslate nohighlight">\(\mathsf{table{.}grow}\)</span> instruction grows table by a given delta and returns the previous size, or <span class="math notranslate nohighlight">\({-1}\)</span> if enough space cannot be allocated.
It also takes an initialization value for the newly allocated entries.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{table{.}fill}\)</span> instruction sets all entries in a range to a given value.
The <span class="math notranslate nohighlight">\(\mathsf{table{.}copy}\)</span> instruction copies elements from a source table region to a possibly overlapping destination region; the first index denotes the destination.
The <span class="math notranslate nohighlight">\(\mathsf{table{.}init}\)</span> instruction copies elements from a <a class="reference internal" href="modules.html#syntax-elem"><span class="std std-ref">passive element segment</span></a> into a table.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{elem{.}drop}\)</span> instruction prevents further use of a passive element segment. This instruction is intended to be used as an optimization hint. After an element segment is dropped its elements can no longer be retrieved, so the memory used by this segment may be freed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An additional instruction that accesses a table is the <a class="reference internal" href="#syntax-instr-control"><span class="std std-ref">control instruction</span></a> <span class="math notranslate nohighlight">\(\mathsf{call\_indirect}\)</span>.</p>
</div>
</section>
<section id="memory-instructions">
<span id="syntax-instr-memory"></span><span id="syntax-lanewidth"></span><span id="syntax-vloadop"></span><span id="syntax-storeop"></span><span id="syntax-loadop"></span><span id="syntax-memarg"></span><span id="syntax-storen"></span><span id="syntax-loadn"></span><span id="index-5"></span><h2>Memory Instructions<a class="headerlink" href="#memory-instructions" title="Link to this heading">¶</a></h2>
<p>Instructions in this group are concerned with linear <a class="reference internal" href="modules.html#syntax-mem"><span class="std std-ref">memory</span></a>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-memarg}{\mathit{memarg}}} &amp; ::= &amp; \{ \begin{array}[t]{&#64;{}l&#64;{}l&#64;{}}
\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{align}}~{\href{../syntax/values.html#syntax-int}{\mathit{u\scriptstyle\kern-0.1em32}}} ,  \href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{offset}}~{\href{../syntax/values.html#syntax-int}{\mathit{u\scriptstyle\kern-0.1em32}}} \} \\
\end{array} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-loadop}{\mathit{loadop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; {{\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ {\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}} &lt; N \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-storeop}{\mathit{storeop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}} &amp; \quad \mbox{if}~ {\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}} &lt; N \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vloadop}{\mathit{vloadop}}}}_{{\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}} &amp; ::= &amp; {{\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ {\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}} \cdot M = {|{\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}|} / 2 \\
&amp; &amp; | &amp; {{\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{splat}}} \\
&amp; &amp; | &amp; {{\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{zero}}} &amp; \quad \mbox{if}~ {\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}} \geq \mathsf{{\scriptstyle 32}} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \dots \\
&amp; &amp; | &amp; {{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}{.}\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{load}}}{{{{\href{../syntax/instructions.html#syntax-loadop}{\mathit{loadop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}}^?}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}}~{\href{../syntax/instructions.html#syntax-memarg}{\mathit{memarg}}} \\
&amp; &amp; | &amp; {{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}{.}\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{store}}}{{{{\href{../syntax/instructions.html#syntax-storeop}{\mathit{storeop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}}^?}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}}~{\href{../syntax/instructions.html#syntax-memarg}{\mathit{memarg}}} \\
&amp; &amp; | &amp; {{\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}{.}\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{load}}}{{{{\href{../syntax/instructions.html#syntax-vloadop}{\mathit{vloadop}}}}_{{\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}}^?}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}}~{\href{../syntax/instructions.html#syntax-memarg}{\mathit{memarg}}} \\
&amp; &amp; | &amp; {{\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}{.}\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{load}}}{{\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{lane}}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}}~{\href{../syntax/instructions.html#syntax-memarg}{\mathit{memarg}}}~{\href{../syntax/instructions.html#syntax-laneidx}{\mathit{laneidx}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}{.}\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{store}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}}~{\href{../syntax/instructions.html#syntax-memarg}{\mathit{memarg}}} \\
&amp; &amp; | &amp; {{\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}{.}\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{store}}}{{\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{lane}}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}}~{\href{../syntax/instructions.html#syntax-memarg}{\mathit{memarg}}}~{\href{../syntax/instructions.html#syntax-laneidx}{\mathit{laneidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{memory{.}size}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{memory{.}grow}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{memory{.}fill}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{memory{.}copy}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{memory{.}init}}~{\href{../syntax/modules.html#syntax-memidx}{\mathit{memidx}}}~{\href{../syntax/modules.html#syntax-dataidx}{\mathit{dataidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-memory}{\mathsf{data{.}drop}}~{\href{../syntax/modules.html#syntax-dataidx}{\mathit{dataidx}}} \\
&amp; &amp; | &amp; \dots \\
\end{array}\end{split}\]</div>
<p>Memory is accessed with <span class="math notranslate nohighlight">\(\mathsf{load}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{store}\)</span> instructions for the different <a class="reference internal" href="types.html#syntax-numtype"><span class="std std-ref">number types</span></a> and <cite>vector types &lt;syntax-vectype&gt;</cite>.
They all take a <a class="reference internal" href="modules.html#syntax-memidx"><span class="std std-ref">memory index</span></a> and a <em>memory argument</em> <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#syntax-memarg}{\mathit{memarg}}}\)</span> that contains an address <em>offset</em> and the expected <em>alignment</em> (expressed as the exponent of a power of 2).</p>
<p>Integer loads and stores can optionally specify a <em>storage size</em> <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}}\)</span> that is smaller than the <a class="reference internal" href="types.html#syntax-numtype"><span class="std std-ref">bit width</span></a> of the respective value type.
In the case of loads, a sign extension mode <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}\)</span> is then required to select appropriate behavior.</p>
<p>Vector loads can specify a shape that is half the <a class="reference internal" href="types.html#syntax-valtype"><span class="std std-ref">bit width</span></a> of <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span>. Each lane is half its usual size, and the sign extension mode <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}\)</span> then specifies how the smaller lane is extended to the larger lane.
Alternatively, vector loads can perform a <em>splat</em>, such that only a single lane of the specified storage size is loaded, and the result is duplicated to all lanes.</p>
<p>The static address offset is added to the dynamic address operand, yielding a 33-bit or 65-bit <em>effective address</em> that is the zero-based index at which the memory is accessed.
All values are read and written in <a class="reference external" href="https://en.wikipedia.org/wiki/Endianness#Little-endian">little endian</a> byte order.
A <a class="reference internal" href="../intro/overview.html#trap"><span class="std std-ref">trap</span></a> results if any of the accessed memory bytes lies outside the address range implied by the memory’s current size.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{memory{.}size}\)</span> instruction returns the current size of a memory.
The <span class="math notranslate nohighlight">\(\mathsf{memory{.}grow}\)</span> instruction grows a memory by a given delta and returns the previous size, or <span class="math notranslate nohighlight">\({-1}\)</span> if enough memory cannot be allocated.
Both instructions operate in units of <a class="reference internal" href="../exec/runtime.html#page-size"><span class="std std-ref">page size</span></a>.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{memory{.}fill}\)</span> instruction sets all values in a regionof a memory to a given byte.
The <span class="math notranslate nohighlight">\(\mathsf{memory{.}copy}\)</span> instruction copies data from a source memory region to a possibly overlapping destination region in another or the same memory; the first index denotes the destination
The <span class="math notranslate nohighlight">\(\mathsf{memory{.}init}\)</span> instruction copies data from a <a class="reference internal" href="modules.html#syntax-data"><span class="std std-ref">passive data segment</span></a> into a memory.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{data{.}drop}\)</span> instruction prevents further use of a passive data segment. This instruction is intended to be used as an optimization hint. After a data segment is dropped its data can no longer be retrieved, so the memory used by this segment may be freed.</p>
</section>
<section id="reference-instructions">
<span id="syntax-instr-ref"></span><span id="syntax-ref-cast"></span><span id="syntax-ref-test"></span><span id="syntax-ref-eq"></span><span id="syntax-ref-as-non-null"></span><span id="syntax-ref-is-null"></span><span id="syntax-ref-func"></span><span id="syntax-ref-null"></span><span id="index-6"></span><h2>Reference Instructions<a class="headerlink" href="#reference-instructions" title="Link to this heading">¶</a></h2>
<p>Instructions in this group are concerned with accessing <a class="reference internal" href="types.html#syntax-reftype"><span class="std std-ref">references</span></a>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \dots \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-ref}{\mathsf{ref{.}func}}~{\href{../syntax/modules.html#syntax-funcidx}{\mathit{funcidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-ref}{\mathsf{ref{.}null}}~{\href{../syntax/types.html#syntax-heaptype}{\mathit{heaptype}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-ref}{\mathsf{ref{.}is\_null}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-ref}{\mathsf{ref{.}as\_non\_null}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-ref}{\mathsf{ref{.}eq}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-ref}{\mathsf{ref{.}test}}~{\href{../syntax/types.html#syntax-reftype}{\mathit{reftype}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-ref}{\mathsf{ref{.}cast}}~{\href{../syntax/types.html#syntax-reftype}{\mathit{reftype}}} \\
&amp; &amp; | &amp; \dots \\
\end{array}\end{split}\]</div>
<p>The <span class="math notranslate nohighlight">\(\mathsf{ref{.}null}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{ref{.}func}\)</span> instructions produce a <a class="reference internal" href="../exec/runtime.html#syntax-nullref"><span class="std std-ref">null</span></a> reference or a reference to a given function, respectively.</p>
<p>The instruction <span class="math notranslate nohighlight">\(\mathsf{ref{.}is\_null}\)</span> checks for null,
while <span class="math notranslate nohighlight">\(\mathsf{ref{.}as\_non\_null}\)</span> converts a <a class="reference internal" href="types.html#syntax-reftype"><span class="std std-ref">nullable</span></a> to a non-null one, and <a class="reference internal" href="../intro/overview.html#trap"><span class="std std-ref">traps</span></a> if it encounters null.</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{ref{.}eq}\)</span> compares two references.</p>
<p>The instructions <span class="math notranslate nohighlight">\(\mathsf{ref{.}test}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{ref{.}cast}\)</span> test the <a class="reference internal" href="../exec/types.html#type-inst"><span class="std std-ref">dynamic type</span></a> of a reference operand.
The former merely returns the result of the test,
while the latter performs a downcast and <a class="reference internal" href="../intro/overview.html#trap"><span class="std std-ref">traps</span></a> if the operand’s type does not match.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <span class="math notranslate nohighlight">\(\mathsf{br\_on\_null}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{br\_on\_non\_null}\)</span> instructions provide versions of <span class="math notranslate nohighlight">\(\mathsf{ref{.}as\_null}\)</span> that branch depending on the success of failure of a null test instead of trapping.
Similarly, the <span class="math notranslate nohighlight">\(\mathsf{br\_on\_cast}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{br\_on\_cast\_fail}\)</span> instructions provides versions of <span class="math notranslate nohighlight">\(\mathsf{ref{.}cast}\)</span> that branch depending on the success of the downcast instead of trapping.</p>
<p>An additional instruction operating on function references is the <a class="reference internal" href="#syntax-instr-control"><span class="std std-ref">control instruction</span></a> <span class="math notranslate nohighlight">\(\mathsf{call\_ref}\)</span>.</p>
</div>
</section>
<section id="aggregate-instructions">
<span id="syntax-instr-extern"></span><span id="syntax-instr-i31"></span><span id="syntax-instr-array"></span><span id="syntax-instr-struct"></span><span id="syntax-extern-convert-any"></span><span id="syntax-any-convert-extern"></span><span id="syntax-i31-get-u"></span><span id="syntax-i31-get-s"></span><span id="syntax-ref-i31"></span><span id="syntax-array-init-elem"></span><span id="syntax-array-init-data"></span><span id="syntax-array-copy"></span><span id="syntax-array-fill"></span><span id="syntax-array-len"></span><span id="syntax-array-set"></span><span id="syntax-array-get-u"></span><span id="syntax-array-get-s"></span><span id="syntax-array-get"></span><span id="syntax-array-new-elem"></span><span id="syntax-array-new-data"></span><span id="syntax-array-new-fixed"></span><span id="syntax-array-new-default"></span><span id="syntax-array-new"></span><span id="syntax-struct-set"></span><span id="syntax-struct-get-u"></span><span id="syntax-struct-get-s"></span><span id="syntax-struct-get"></span><span id="syntax-struct-new-default"></span><span id="syntax-struct-new"></span><span id="index-7"></span><h2>Aggregate Instructions<a class="headerlink" href="#aggregate-instructions" title="Link to this heading">¶</a></h2>
<p>Instructions in this group are concerned with creating and accessing <a class="reference internal" href="types.html#syntax-reftype"><span class="std std-ref">references</span></a> to <a class="reference internal" href="types.html#syntax-aggrtype"><span class="std std-ref">aggregate</span></a> types.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \dots \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-struct}{\mathsf{struct{.}new}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-struct}{\mathsf{struct{.}new\_default}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-struct}{\mathsf{struct{.}get}}}{\mathsf{\_}}{{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}^?}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}}~{\href{../syntax/values.html#syntax-int}{\mathit{u\scriptstyle\kern-0.1em32}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-struct}{\mathsf{struct{.}set}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}}~{\href{../syntax/values.html#syntax-int}{\mathit{u\scriptstyle\kern-0.1em32}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}new}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}new\_default}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}new\_fixed}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}}~{\href{../syntax/values.html#syntax-int}{\mathit{u\scriptstyle\kern-0.1em32}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}new\_data}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}}~{\href{../syntax/modules.html#syntax-dataidx}{\mathit{dataidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}new\_elem}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}}~{\href{../syntax/modules.html#syntax-elemidx}{\mathit{elemidx}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}get}}}{\mathsf{\_}}{{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}^?}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}set}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}len}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}fill}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}copy}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}init\_data}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}}~{\href{../syntax/modules.html#syntax-dataidx}{\mathit{dataidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-array}{\mathsf{array{.}init\_elem}}~{\href{../syntax/modules.html#syntax-typeidx}{\mathit{typeidx}}}~{\href{../syntax/modules.html#syntax-elemidx}{\mathit{elemidx}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-i31}{\mathsf{ref{.}i\scriptstyle31}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-i31}{\mathsf{i{\scriptstyle31}{.}get}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-extern}{\mathsf{extern{.}convert\_any}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-extern}{\mathsf{any{.}convert\_extern}} \\
&amp; &amp; | &amp; \dots \\
\end{array}\end{split}\]</div>
<p>The instructions <span class="math notranslate nohighlight">\(\mathsf{struct{.}new}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{struct{.}new\_default}\)</span> allocate a new <a class="reference internal" href="types.html#syntax-structtype"><span class="std std-ref">structure</span></a>, initializing them either with operands or with default values.
The remaining instructions on structs access individual fields,
allowing for different sign extension modes in the case of <a class="reference internal" href="types.html#syntax-packtype"><span class="std std-ref">packed</span></a> storage types.</p>
<p>Similarly, <a class="reference internal" href="types.html#syntax-arraytype"><span class="std std-ref">arrays</span></a> can be allocated either with an explicit initialization operand or a default value.
Furthermore, <span class="math notranslate nohighlight">\(\mathsf{array{.}new\_fixed}\)</span> allocates an array with statically fixed size,
and <span class="math notranslate nohighlight">\(\mathsf{array{.}new\_data}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{array{.}new\_elem}\)</span> allocate an array and initialize it from a <a class="reference internal" href="modules.html#syntax-data"><span class="std std-ref">data</span></a> or <a class="reference internal" href="modules.html#syntax-elem"><span class="std std-ref">element</span></a> segment, respectively.
The instructions <span class="math notranslate nohighlight">\(\mathsf{array{.}get}\)</span>, <span class="math notranslate nohighlight">\(\mathsf{array{.}get}~{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}\)</span>, and <span class="math notranslate nohighlight">\(\mathsf{array{.}set}\)</span> access individual slots,
again allowing for different sign extension modes in the case of a <a class="reference internal" href="types.html#syntax-packtype"><span class="std std-ref">packed</span></a> storage type;
<span class="math notranslate nohighlight">\(\mathsf{array{.}len}\)</span> produces the length of an array;
<span class="math notranslate nohighlight">\(\mathsf{array{.}fill}\)</span> fills a specified slice of an array with a given value and <span class="math notranslate nohighlight">\(\mathsf{array{.}copy}\)</span>, <span class="math notranslate nohighlight">\(\mathsf{array{.}init\_data}\)</span>, and <span class="math notranslate nohighlight">\(\mathsf{array{.}init\_elem}\)</span> copy elements to a specified slice of an array from a given array, data segment, or element segment, respectively.</p>
<p>The instructions <span class="math notranslate nohighlight">\(\mathsf{ref{.}i{\scriptstyle 31}}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{i{\scriptstyle 31}{.}get}~{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}\)</span> convert between type <span class="math notranslate nohighlight">\(\mathsf{i{\scriptstyle 32}}\)</span> and an unboxed <a class="reference internal" href="types.html#syntax-i31"><span class="std std-ref">scalar</span></a>.</p>
<p>The instructions <span class="math notranslate nohighlight">\(\mathsf{any{.}convert\_extern}\)</span> and <span class="math notranslate nohighlight">\(\mathsf{extern{.}convert\_any}\)</span> allow lossless conversion between references represented as type <span class="math notranslate nohighlight">\((\href{../syntax/types.html#syntax-reftype}{\mathsf{ref}}~\href{../syntax/types.html#syntax-reftype}{\mathsf{null}}~\href{../syntax/types.html#syntax-heaptype}{\mathsf{extern}})\)</span> and as <span class="math notranslate nohighlight">\((\href{../syntax/types.html#syntax-reftype}{\mathsf{ref}}~\href{../syntax/types.html#syntax-reftype}{\mathsf{null}}~\href{../syntax/types.html#syntax-heaptype}{\mathsf{any}})\)</span>.</p>
</section>
<section id="numeric-instructions">
<span id="syntax-instr-numeric"></span><span id="syntax-cvtop"></span><span id="syntax-relop"></span><span id="syntax-testop"></span><span id="syntax-binop"></span><span id="syntax-unop"></span><span id="syntax-const"></span><span id="syntax-num"></span><span id="syntax-sz"></span><span id="syntax-sx"></span><span id="index-8"></span><h2>Numeric Instructions<a class="headerlink" href="#numeric-instructions" title="Link to this heading">¶</a></h2>
<p>Numeric instructions provide basic operations over numeric <a class="reference internal" href="values.html#syntax-value"><span class="std std-ref">values</span></a> of specific <a class="reference internal" href="types.html#syntax-numtype"><span class="std std-ref">type</span></a>.
These operations closely match respective operations available in hardware.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}} &amp; ::= &amp; \mathsf{{\scriptstyle 8}} ~~|~~ \mathsf{{\scriptstyle 16}} ~~|~~ \mathsf{{\scriptstyle 32}} ~~|~~ \mathsf{{\scriptstyle 64}} \\
&amp; {\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-sx}{\mathsf{u}} ~~|~~ \href{../syntax/instructions.html#syntax-sx}{\mathsf{s}} \\[0.8ex]
&amp; {{\href{../exec/runtime.html#syntax-num}{\mathit{num}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; {{\href{../syntax/values.html#syntax-int}{\mathit{i}\kern-0.1em}}}{N} \\
&amp; {{\href{../exec/runtime.html#syntax-num}{\mathit{num}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; {{\href{../syntax/values.html#syntax-float}{\mathit{f}\kern-0.15em}}}{N} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \dots \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}{.}\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{const}}~{{\href{../exec/runtime.html#syntax-num}{\mathit{num}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}} {.} {{\href{../syntax/instructions.html#syntax-unop}{\mathit{unop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}} {.} {{\href{../syntax/instructions.html#syntax-binop}{\mathit{binop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}} {.} {{\href{../syntax/instructions.html#syntax-testop}{\mathit{testop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}} {.} {{\href{../syntax/instructions.html#syntax-relop}{\mathit{relop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}_1 {.} {{{\href{../syntax/instructions.html#syntax-cvtop}{\mathit{cvtop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}_2, {\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}_1}}{\mathsf{\_}}{{\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}}_2} \\
&amp; &amp; | &amp; \dots \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-unop}{\mathit{unop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{clz}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{ctz}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{popcnt}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{extend}}}{{\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-sx}{\mathsf{s}}} &amp; \quad \mbox{if}~ {\href{../syntax/instructions.html#syntax-sz}{\mathit{sz}}} &lt; N \\
&amp; {{\href{../syntax/instructions.html#syntax-unop}{\mathit{unop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{abs}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{neg}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{sqrt}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{ceil}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{floor}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{trunc}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{nearest}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-binop}{\mathit{binop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{add}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{sub}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{mul}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{div}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{rem}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{and}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{or}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{xor}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{shl}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{shr}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{rotl}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{rotr}} \\
&amp; {{\href{../syntax/instructions.html#syntax-binop}{\mathit{binop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{add}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{sub}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{mul}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{div}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{min}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{max}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{copysign}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-testop}{\mathit{testop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{eqz}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-relop}{\mathit{relop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{eq}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{ne}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{lt}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{gt}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{le}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{ge}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} \\
&amp; {{\href{../syntax/instructions.html#syntax-relop}{\mathit{relop}}}}_{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{eq}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{ne}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{lt}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{gt}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{le}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{ge}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-cvtop}{\mathit{cvtop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1, {{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{extend}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N_1 &lt; N_2 \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{wrap}} &amp; \quad \mbox{if}~ N_1 &gt; N_2 \\
&amp; {{\href{../syntax/instructions.html#syntax-cvtop}{\mathit{cvtop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1, {{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{convert}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{reinterpret}} &amp; \quad \mbox{if}~ N_1 = N_2 \\
&amp; {{\href{../syntax/instructions.html#syntax-cvtop}{\mathit{cvtop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1, {{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{trunc}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{trunc\_sat}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{reinterpret}} &amp; \quad \mbox{if}~ N_1 = N_2 \\
&amp; {{\href{../syntax/instructions.html#syntax-cvtop}{\mathit{cvtop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1, {{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{promote}} &amp; \quad \mbox{if}~ N_1 &lt; N_2 \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{demote}} &amp; \quad \mbox{if}~ N_1 &gt; N_2 \\
\end{array}\end{split}\]</div>
<p>Numeric instructions are divided by <a class="reference internal" href="types.html#syntax-numtype"><span class="std std-ref">number type</span></a>.
For each type, several subcategories can be distinguished:</p>
<ul class="simple">
<li><p><em>Constants</em>: return a static constant.</p></li>
<li><p><em>Unary Operations</em>: consume one operand and produce one result of the respective type.</p></li>
<li><p><em>Binary Operations</em>: consume two operands and produce one result of the respective type.</p></li>
<li><p><em>Tests</em>: consume one operand of the respective type and produce a Boolean integer result.</p></li>
<li><p><em>Comparisons</em>: consume two operands of the respective type and produce a Boolean integer result.</p></li>
<li><p><em>Conversions</em>: consume a value of one type and produce a result of another
(the source type of the conversion is the one after the “<span class="math notranslate nohighlight">\(\mathsf{\_}\)</span>”).</p></li>
</ul>
<p>Some integer instructions come in two flavors,
where a signedness annotation <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}\)</span> distinguishes whether the operands are to be <a class="reference internal" href="../exec/numerics.html#aux-signed"><span class="std std-ref">interpreted</span></a> as <a class="reference internal" href="values.html#syntax-uint"><span class="std std-ref">unsigned</span></a> or <a class="reference internal" href="values.html#syntax-sint"><span class="std std-ref">signed</span></a> integers.
For the other integer instructions, the use of two’s complement for the signed interpretation means that they behave the same regardless of signedness.</p>
</section>
<section id="vector-instructions">
<span id="syntax-instr-vec-relaxed"></span><span id="syntax-instr-vec"></span><span id="syntax-vcvtop"></span><span id="syntax-vextternop"></span><span id="syntax-vextbinop"></span><span id="syntax-vextunop"></span><span id="syntax-vternop"></span><span id="syntax-vbinop"></span><span id="syntax-vunop"></span><span id="syntax-vshiftop"></span><span id="syntax-vswizzlop"></span><span id="syntax-vrelop"></span><span id="syntax-vtestop"></span><span id="syntax-vvtestop"></span><span id="syntax-vvternop"></span><span id="syntax-vvbinop"></span><span id="syntax-vvunop"></span><span id="syntax-zero"></span><span id="syntax-half"></span><span id="syntax-shape"></span><span id="syntax-dim"></span><span id="syntax-lanetype"></span><span id="syntax-laneidx"></span><span id="index-9"></span><h2>Vector Instructions<a class="headerlink" href="#vector-instructions" title="Link to this heading">¶</a></h2>
<p>Vector instructions (also known as <em>SIMD</em> instructions, <em>single instruction multiple data</em>) provide basic operations over <a class="reference internal" href="values.html#syntax-value"><span class="std std-ref">values</span></a> of <a class="reference internal" href="types.html#syntax-vectype"><span class="std std-ref">vector type</span></a>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-lanetype}{\mathit{lanetype}}} &amp; ::= &amp; {\href{../syntax/types.html#syntax-numtype}{\mathit{numtype}}} ~~|~~ {\href{../syntax/types.html#syntax-packtype}{\mathit{packtype}}} \\
&amp; {\href{../syntax/instructions.html#syntax-dim}{\mathit{dim}}} &amp; ::= &amp; \mathsf{{\scriptstyle 1}} ~~|~~ \mathsf{{\scriptstyle 2}} ~~|~~ \mathsf{{\scriptstyle 4}} ~~|~~ \mathsf{{\scriptstyle 8}} ~~|~~ \mathsf{{\scriptstyle 16}} \\
&amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}} &amp; ::= &amp; {{\href{../syntax/instructions.html#syntax-lanetype}{\mathit{lanetype}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{{\href{../syntax/instructions.html#syntax-dim}{\mathit{dim}}}} &amp; \quad \mbox{if}~ {|{\href{../syntax/instructions.html#syntax-lanetype}{\mathit{lanetype}}}|} \cdot {\href{../syntax/instructions.html#syntax-dim}{\mathit{dim}}} = 128 \\
&amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}} &amp; \quad \mbox{if}~ {\href{../syntax/instructions.html#aux-lanetype}{\mathrm{lanetype}}}({\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}) = {\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}} \\
&amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{bshape}}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}} &amp; \quad \mbox{if}~ {\href{../syntax/instructions.html#aux-lanetype}{\mathrm{lanetype}}}({\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}) = \href{../syntax/types.html#syntax-storagetype}{\mathsf{i\scriptstyle8}} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-half}{\mathit{half}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{low}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{high}} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-zero}{\mathit{zero}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{zero}} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-laneidx}{\mathit{laneidx}}} &amp; ::= &amp; {\href{../syntax/values.html#syntax-int}{\mathit{u\scriptstyle\kern-0.1em8}}} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}} &amp; ::= &amp; \dots \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}{.}\href{../syntax/instructions.html#syntax-instr-numeric}{\mathsf{const}}~{{\href{../exec/runtime.html#syntax-vec}{\mathit{vec}}}}_{{\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}} {.} {\href{../syntax/instructions.html#syntax-vvunop}{\mathit{vvunop}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}} {.} {\href{../syntax/instructions.html#syntax-vvbinop}{\mathit{vvbinop}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}} {.} {\href{../syntax/instructions.html#syntax-vvternop}{\mathit{vvternop}}} \\
&amp; &amp; | &amp; {\href{../syntax/types.html#syntax-vectype}{\mathit{vectype}}} {.} {\href{../syntax/instructions.html#syntax-vvtestop}{\mathit{vvtestop}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}} {.} {{\href{../syntax/instructions.html#syntax-vunop}{\mathit{vunop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}} {.} {{\href{../syntax/instructions.html#syntax-vbinop}{\mathit{vbinop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}} {.} {{\href{../syntax/instructions.html#syntax-vternop}{\mathit{vternop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}} {.} {{\href{../syntax/instructions.html#syntax-vrelop}{\mathit{vtestop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}} {.} {{\href{../syntax/instructions.html#syntax-vrelop}{\mathit{vrelop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}} {.} {{\href{../syntax/instructions.html#syntax-vshiftop}{\mathit{vshiftop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}{.}\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{bitmask}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{bshape}}} {.} {{\href{../syntax/instructions.html#syntax-vswizzlop}{\mathit{vswizzlop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{bshape}}}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{bshape}}}{.}\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{shuffle}}~{{\href{../syntax/instructions.html#syntax-laneidx}{\mathit{laneidx}}}^\ast} &amp; \quad \mbox{if}~ {|{{\href{../syntax/instructions.html#syntax-laneidx}{\mathit{laneidx}}}^\ast}|} = {\href{../syntax/instructions.html#aux-dim}{\mathrm{dim}}}({\href{../syntax/instructions.html#syntax-shape}{\mathit{bshape}}}) \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_1 {.} {{{\href{../syntax/instructions.html#syntax-vextunop}{\mathit{vextunop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_2, {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_1}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_2} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_1 {.} {{{\href{../syntax/instructions.html#syntax-vextbinop}{\mathit{vextbinop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_2, {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_1}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_2} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_1 {.} {{{\href{../syntax/instructions.html#syntax-vextternop}{\mathit{vextternop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_2, {\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_1}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_2} \\
&amp; &amp; | &amp; {{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_1{.}\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{narrow}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_2}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ {|{\href{../syntax/instructions.html#aux-lanetype}{\mathrm{lanetype}}}({\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_2)|} = 2 \cdot {|{\href{../syntax/instructions.html#aux-lanetype}{\mathrm{lanetype}}}({\href{../syntax/instructions.html#syntax-shape}{\mathit{ishape}}}_1)|} \leq \mathsf{{\scriptstyle 32}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}_1 {.} {{{\href{../syntax/instructions.html#syntax-vcvtop}{\mathit{vcvtop}}}}_{{\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}_2, {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}_1}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}_2} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}{.}\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{splat}} \\
&amp; &amp; | &amp; {{\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}{.}\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{extract\_lane}}}{\mathsf{\_}}{{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}^?}}~{\href{../syntax/instructions.html#syntax-laneidx}{\mathit{laneidx}}} &amp; \quad \mbox{if}~ {{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}^?} = \epsilon \Leftrightarrow {\href{../syntax/instructions.html#aux-lanetype}{\mathrm{lanetype}}}({\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}) \in \href{../syntax/types.html#syntax-numtype}{\mathsf{i\scriptstyle32}}~\href{../syntax/types.html#syntax-numtype}{\mathsf{i\scriptstyle64}}~\href{../syntax/types.html#syntax-numtype}{\mathsf{f\scriptstyle32}}~\href{../syntax/types.html#syntax-numtype}{\mathsf{f\scriptstyle64}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}}{.}\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{replace\_lane}}~{\href{../syntax/instructions.html#syntax-laneidx}{\mathit{laneidx}}} \\
&amp; &amp; | &amp; \dots \\
\end{array}\end{split}\]</div>
<p>Vector instructions have a naming convention involving a <em>shape</em> prefix that
determines how their operands will be interpreted,
written <span class="math notranslate nohighlight">\({t}{\mathsf{x}}{N}\)</span>, and consisting of a <em>lane type</em> <span class="math notranslate nohighlight">\(t\)</span>, a possibly <em>packed</em> <a class="reference internal" href="types.html#syntax-numtype"><span class="std std-ref">numeric type</span></a>, and its <em>dimension</em> <span class="math notranslate nohighlight">\(N\)</span>, which denotes the number of lanes of that type.
Operations are performed point-wise on the values of each lane.</p>
<p>Instructions prefixed with <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> do not involve a specific interpretation, and treat the <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> as either an <span class="math notranslate nohighlight">\({\mathit{i{\kern-0.1em\scriptstyle 128}}}\)</span> value or a vector of <span class="math notranslate nohighlight">\(128\)</span> individual bits.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For example, the shape <span class="math notranslate nohighlight">\({\href{../syntax/types.html#syntax-numtype}{\mathsf{i\scriptstyle32}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{\mathsf{{\scriptstyle 4}}}\)</span> interprets the operand
as four <span class="math notranslate nohighlight">\({\mathit{i{\kern-0.1em\scriptstyle 32}}}\)</span> values, packed into an <span class="math notranslate nohighlight">\({\mathit{i{\kern-0.1em\scriptstyle 128}}}\)</span>.
The bit width of the lane type <span class="math notranslate nohighlight">\(t\)</span> times <span class="math notranslate nohighlight">\(N\)</span> always is <span class="math notranslate nohighlight">\(128\)</span>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-vvunop}{\mathit{vvunop}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{not}} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-vvbinop}{\mathit{vvbinop}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{and}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{andnot}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{or}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{xor}} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-vvternop}{\mathit{vvternop}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{bitselect}} \\[0.8ex]
&amp; {\href{../syntax/instructions.html#syntax-vvtestop}{\mathit{vvtestop}}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{any\_true}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vunop}{\mathit{vunop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{abs}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{neg}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{popcnt}} &amp; \quad \mbox{if}~ N = \mathsf{{\scriptstyle 8}} \\
&amp; {{\href{../syntax/instructions.html#syntax-vunop}{\mathit{vunop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{abs}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{neg}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{sqrt}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{ceil}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{floor}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{trunc}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{nearest}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vbinop}{\mathit{vbinop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{add}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{sub}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{add\_sat}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N \leq \mathsf{{\scriptstyle 16}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{sub\_sat}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N \leq \mathsf{{\scriptstyle 16}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{mul}} &amp; \quad \mbox{if}~ N \geq \mathsf{{\scriptstyle 16}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{avgr}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-sx}{\mathsf{u}}} &amp; \quad \mbox{if}~ N \leq \mathsf{{\scriptstyle 16}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{q{\scriptstyle15}mulr\_sat}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-sx}{\mathsf{s}}} &amp; \quad \mbox{if}~ N = \mathsf{{\scriptstyle 16}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_q15mulr}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-sx}{\mathsf{s}}} &amp; \quad \mbox{if}~ N = \mathsf{{\scriptstyle 16}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{min}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N \leq \mathsf{{\scriptstyle 32}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{max}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N \leq \mathsf{{\scriptstyle 32}} \\
&amp; {{\href{../syntax/instructions.html#syntax-vbinop}{\mathit{vbinop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{add}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{sub}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{mul}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{div}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{min}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{max}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{pmin}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{pmax}} \\
&amp; &amp; | &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_min}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_max}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vternop}{\mathit{vternop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_laneselect}} \\
&amp; {{\href{../syntax/instructions.html#syntax-vternop}{\mathit{vternop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_madd}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_nmadd}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vrelop}{\mathit{vtestop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{all\_true}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vrelop}{\mathit{vrelop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{eq}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{ne}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{lt}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N \neq \mathsf{{\scriptstyle 64}} \lor {\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}} = \href{../syntax/instructions.html#syntax-sx}{\mathsf{s}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{gt}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N \neq \mathsf{{\scriptstyle 64}} \lor {\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}} = \href{../syntax/instructions.html#syntax-sx}{\mathsf{s}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{le}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N \neq \mathsf{{\scriptstyle 64}} \lor {\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}} = \href{../syntax/instructions.html#syntax-sx}{\mathsf{s}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{ge}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N \neq \mathsf{{\scriptstyle 64}} \lor {\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}} = \href{../syntax/instructions.html#syntax-sx}{\mathsf{s}} \\
&amp; {{\href{../syntax/instructions.html#syntax-vrelop}{\mathit{vrelop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{eq}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{ne}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{lt}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{gt}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{le}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{ge}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vswizzlop}{\mathit{vswizzlop}}}}_{{\href{../syntax/types.html#syntax-storagetype}{\mathsf{i\scriptstyle8}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{swizzle}} ~~|~~ \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_swizzle}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vshiftop}{\mathit{vshiftop}}}}_{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M}} &amp; ::= &amp; \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{shl}} ~~|~~ {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{shr}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vextunop}{\mathit{vextunop}}}}_{{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_1}, {{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_2}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{extadd\_pairwise}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ 16 \leq 2 \cdot N_1 = N_2 \leq \mathsf{{\scriptstyle 32}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vextbinop}{\mathit{vextbinop}}}}_{{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_1}, {{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_2}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{extmul}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-half}{\mathit{half}}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ 2 \cdot N_1 = N_2 \geq \mathsf{{\scriptstyle 16}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{dot}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-sx}{\mathsf{s}}} &amp; \quad \mbox{if}~ 2 \cdot N_1 = N_2 = \mathsf{{\scriptstyle 32}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_dot}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-sx}{\mathsf{s}}} &amp; \quad \mbox{if}~ 2 \cdot N_1 = N_2 = \mathsf{{\scriptstyle 16}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vextternop}{\mathit{vextternop}}}}_{{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_1}, {{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_2}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_dot\_add}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-sx}{\mathsf{s}}} &amp; \quad \mbox{if}~ 4 \cdot N_1 = N_2 = \mathsf{{\scriptstyle 32}} \\[0.8ex]
&amp; {{\href{../syntax/instructions.html#syntax-vcvtop}{\mathit{vcvtop}}}}_{{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_1}, {{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_2}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{extend}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-half}{\mathit{half}}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N_2 = 2 \cdot N_1 \\
&amp; {{\href{../syntax/instructions.html#syntax-vcvtop}{\mathit{vcvtop}}}}_{{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_1}, {{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_2}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{convert}}}{\mathsf{\_}}{{{\href{../syntax/instructions.html#syntax-half}{\mathit{half}}}^?}~{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}} &amp; \quad \mbox{if}~ N_2 = N_1 = \mathsf{{\scriptstyle 32}} \land {{\href{../syntax/instructions.html#syntax-half}{\mathit{half}}}^?} = \epsilon \lor N_2 = 2 \cdot N_1 \land {{\href{../syntax/instructions.html#syntax-half}{\mathit{half}}}^?} = \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{low}} \\
&amp; {{\href{../syntax/instructions.html#syntax-vcvtop}{\mathit{vcvtop}}}}_{{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_1}, {{{\href{../syntax/types.html#syntax-numtype}{\mathsf{i}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_2}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{trunc\_sat}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}~{{\href{../syntax/instructions.html#syntax-zero}{\mathit{zero}}}^?}} &amp; \quad \mbox{if}~ N_1 = N_2 = \mathsf{{\scriptstyle 32}} \land {{\href{../syntax/instructions.html#syntax-zero}{\mathit{zero}}}^?} = \epsilon \lor N_1 = 2 \cdot N_2 \land {{\href{../syntax/instructions.html#syntax-zero}{\mathit{zero}}}^?} = \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{zero}} \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{relaxed\_trunc}}}{\mathsf{\_}}{{\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}~{{\href{../syntax/instructions.html#syntax-zero}{\mathit{zero}}}^?}} &amp; \quad \mbox{if}~ N_1 = N_2 = \mathsf{{\scriptstyle 32}} \land {{\href{../syntax/instructions.html#syntax-zero}{\mathit{zero}}}^?} = \epsilon \lor N_1 = 2 \cdot N_2 \land {{\href{../syntax/instructions.html#syntax-zero}{\mathit{zero}}}^?} = \href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{zero}} \\
&amp; {{\href{../syntax/instructions.html#syntax-vcvtop}{\mathit{vcvtop}}}}_{{{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_1}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_1}, {{{\href{../syntax/types.html#syntax-numtype}{\mathsf{f}}}{{\href{../syntax/types.html#syntax-numtype}{\scriptstyle\kern-0.1emN}}}}_2}{\href{../syntax/instructions.html#syntax-shape}{\mathsf{x}}}{M_2}} &amp; ::= &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{demote}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{zero}}} &amp; \quad \mbox{if}~ N_1 = 2 \cdot N_2 \\
&amp; &amp; | &amp; {\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{promote}}}{\mathsf{\_}}{\href{../syntax/instructions.html#syntax-instr-vec}{\mathsf{low}}} &amp; \quad \mbox{if}~ 2 \cdot N_1 = N_2 \\
\end{array}\end{split}\]</div>
<p>Vector instructions can be grouped into several subcategories:</p>
<ul class="simple">
<li><p><em>Constants</em>: return a static constant.</p></li>
<li><p><em>Unary Operations</em>: consume one <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> operand and produce one <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> result.</p></li>
<li><p><em>Binary Operations</em>: consume two <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> operands and produce one <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> result.</p></li>
<li><p><em>Ternary Operations</em>: consume three <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> operands and produce one <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> result.</p></li>
<li><p><em>Tests</em>: consume one <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> operand and produce a Boolean integer result.</p></li>
<li><p><em>Shifts</em>: consume a <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> operand and an <span class="math notranslate nohighlight">\(\mathsf{i{\scriptstyle 32}}\)</span> operand, producing one <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> result.</p></li>
<li><p><em>Splats</em>: consume a value of numeric type and produce a <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> result of a specified shape.</p></li>
<li><p><em>Extract lanes</em>: consume a <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> operand and return the numeric value in a given lane.</p></li>
<li><p><em>Replace lanes</em>: consume a <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> operand and a numeric value for a given lane, and produce a <span class="math notranslate nohighlight">\(\mathsf{v{\scriptstyle 128}}\)</span> result.</p></li>
</ul>
<p>Some vector instructions have a signedness annotation <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#syntax-sx}{\mathit{sx}}}\)</span> which distinguishes whether the elements in the operands are to be <a class="reference internal" href="../exec/numerics.html#aux-signed"><span class="std std-ref">interpreted</span></a> as <a class="reference internal" href="values.html#syntax-uint"><span class="std std-ref">unsigned</span></a> or <a class="reference internal" href="values.html#syntax-sint"><span class="std std-ref">signed</span></a> integers.
For the other vector instructions, the use of two’s complement for the signed interpretation means that they behave the same regardless of signedness.</p>
<section id="conventions">
<span id="aux-halfop"></span><span id="aux-zeroop"></span><span id="aux-dim"></span><span id="aux-lanetype"></span><h3>Conventions<a class="headerlink" href="#conventions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The function <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#aux-lanetype}{\mathrm{lanetype}}}({\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}})\)</span> extracts the lane type of a shape.</p></li>
<li><p>The function <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#aux-dim}{\mathrm{dim}}}({\href{../syntax/instructions.html#syntax-shape}{\mathit{shape}}})\)</span> extracts the dimension of a shape.</p></li>
<li><p>The function <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#aux-zeroop}{\mathrm{zeroop}}}({\href{../syntax/instructions.html#syntax-vcvtop}{\mathit{vcvtop}}})\)</span> extracts the <span class="math notranslate nohighlight">\(\mathsf{zero}\)</span> flag from a vector conversion operator, or returns <span class="math notranslate nohighlight">\(\epsilon\)</span> if it does not contain any.</p></li>
<li><p>The function <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#aux-halfop}{\mathrm{halfop}}}({\href{../syntax/instructions.html#syntax-vcvtop}{\mathit{vcvtop}}})\)</span> extracts the <span class="math notranslate nohighlight">\({\href{../syntax/instructions.html#syntax-half}{\mathit{half}}}\)</span> flag from a vector conversion operator, or returns <span class="math notranslate nohighlight">\(\epsilon\)</span> if it does not contain any.</p></li>
</ul>
</section>
</section>
<section id="expressions">
<span id="syntax-expr"></span><span id="index-10"></span><h2>Expressions<a class="headerlink" href="#expressions" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="modules.html#syntax-func"><span class="std std-ref">Function</span></a> bodies, initialization values for <a class="reference internal" href="modules.html#syntax-global"><span class="std std-ref">globals</span></a>, elements and offsets of <a class="reference internal" href="modules.html#syntax-elem"><span class="std std-ref">element</span></a> segments, and offsets of <a class="reference internal" href="modules.html#syntax-data"><span class="std std-ref">data</span></a> segments are given as expressions, which are sequences of <a class="reference internal" href="#syntax-instr"><span class="std std-ref">instructions</span></a>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}[t]{&#64;{}l&#64;{}rrl&#64;{}l&#64;{}}
&amp; {\href{../syntax/instructions.html#syntax-expr}{\mathit{expr}}} &amp; ::= &amp; {{\href{../syntax/instructions.html#syntax-instr}{\mathit{instr}}}^\ast} \\
\end{array}\end{split}\]</div>
<p>In some places, validation <a class="reference internal" href="../valid/instructions.html#valid-constant"><span class="std std-ref">restricts</span></a> expressions to be <em>constant</em>, which limits the set of allowable instructions.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;2017-2025, WebAssembly Community Group.
      
    </div>

    

    
  </body>
</html>